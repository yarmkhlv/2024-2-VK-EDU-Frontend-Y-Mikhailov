(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();const d={CHAT_LIST:document.querySelector(".chat-list"),CREATE_NEW_CHAT_BTN:document.querySelector(".create-chat-btn")};function m(r){const t=new Date(r),s=new Date,o=Intl.DateTimeFormat().resolvedOptions().timeZone,e=t.toLocaleDateString("ru-RU",{timeZone:o}),n=s.toLocaleDateString("ru-RU",{timeZone:o});return e===n?t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",timeZone:o}):t.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:o})}function p(){return Math.floor(Math.random()*1e4)+1}function u(r){const t=document.createElement("a"),s=document.createElement("div"),o=document.createElement("img"),e=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),c=document.createElement("div"),i=document.createElement("div");if(s.classList.add("user-chat"),o.classList.add("user-chat__img"),e.classList.add("user-chat__info"),n.classList.add("user-chat__info_upper"),a.classList.add("user-chat__info_bottom"),c.classList.add("user-chat__info_upper_title"),i.classList.add("user-chat__info_upper_last-message-status"),t.classList.add("link-wrapper-chat"),t.href=`chat.html?user=${r.id}`,c.textContent=`${r.name}`,r.messages.length>0){const l=r.messages[r.messages.length-1];a.textContent=`${l.text}`,i.textContent=`${m(l.date)}`}else a.textContent="Пока сообщений в чате нет";o.src=r.avatarUrl,o.alt=`${r.name} аватар`,s.append(o,e),e.append(n,a),n.append(c,i),t.appendChild(s),d.CHAT_LIST.appendChild(t)}function f(r){const t=p(),s=JSON.parse(localStorage.getItem("users"))||[],o={id:t,name:r,avatarUrl:`https://api.dicebear.com/9.x/lorelei/svg?seed=${r+t}`,messages:[]};s.push(o),localStorage.setItem("users",JSON.stringify(s)),u(o)}d.CREATE_NEW_CHAT_BTN.addEventListener("click",r=>{r.preventDefault();const t=prompt("Введите имя собеседника:");t.trim()&&f(t)});function g(){(JSON.parse(localStorage.getItem("users"))||[]).forEach(u)}g();
